<?xml version="1.0" encoding="utf-8" ?>

<Patch>
	<Operation Class="PatchOperationConditional">
	<!-- Does this exist/ -->
		<xpath>Defs/ThingDef[defName="AB_Mudstone"]</xpath>
		<!-- If it does, add this replacement. -->
		<match Class="PatchOperationReplace">
			<success>Always</success>
			<xpath>Defs/BiomeDef[defName="froggySwamp"]/forceRockTypes</xpath>
			<value>
				<forceRockTypes>
					<li>AB_Mudstone</li>
				</forceRockTypes>
			</value>
		</match>
		<!-- If the first XPATH does not exist, the original code stands. -->
	</Operation>
	
	<Operation Class="PatchOperationConditional">
	<!-- DO THE GENTILES KNOW? -->
		<xpath>Defs/ThingDef[defName="AB_Mudstone"]</xpath>
		<!-- If they do, SHUT IT DOWN. -->
		<match Class="PatchOperationRemove">
			<success>Always</success>
			<xpath>Defs/BiomeDef[defName="froggySwamp"]/modExtensions/li[@Class="VFECore.BiomeExtension"]/uniqueRockTypes</xpath>
		</match>
		<!-- If the first XPATH does not exist, the original code stands. -->
	</Operation>
	
	<Operation Class="PatchOperationConditional">
	<!-- Does this exist? -->
		<xpath>Defs/ThingDef[defName="AB_Mudstone"]</xpath>
		<!-- If it does, add this replacement. -->
		<match Class="PatchOperationReplace">
			<success>Always</success>
			<xpath>Defs/BiomeDef[defName="froggySwamp"]/modExtensions/li[@Class="VFECore.BiomeExtension"]/forceUniqueRockTypes</xpath>
			<value>
				<forceUniqueRockTypes>false</forceUniqueRockTypes>
			</value>
		</match>
		<!-- If the first XPATH does not exist, the original code stands. -->
	</Operation>
	
	<Operation Class="PatchOperationConditional">
	<!-- DO THE GENTILES KNOW? -->
		<xpath>Defs/ThingDef[defName="AB_Mudstone"]</xpath>
		<!-- If they do, SHUT IT DOWN. -->
		<match Class="PatchOperationRemove">
			<success>Always</success>
			<xpath>Defs/ThingDef[defName="ST_MudStone"]</xpath>
		</match>
		<!-- If the first XPATH does not exist, the original code stands. All according to plan. -->
	</Operation>
	
	<Operation Class="PatchOperationConditional">
	<!-- DO THE GENTILES KNOW? -->
		<xpath>Defs/ThingDef[defName="AB_Mudstone"]</xpath>
		<!-- If they do, SHUT IT DOWN. -->
		<match Class="PatchOperationRemove">
			<success>Always</success>
			<xpath>Defs/ThingDef[defName="ST_SmoothedMudstone"]</xpath>
		</match>
		<!-- If the first XPATH does not exist, the original code stands. All according to plan. -->
	</Operation>
	
	<Operation Class="PatchOperationConditional">
	<!-- DO THE GENTILES KNOW? -->
		<xpath>Defs/ThingDef[defName="AB_Mudstone"]</xpath>
		<!-- If they do, SHUT IT DOWN. -->
		<match Class="PatchOperationRemove">
			<success>Always</success>
			<xpath>Defs/ThingDef[defName="ST_ChunkMudstone"]</xpath>
		</match>
		<!-- If the first XPATH does not exist, the original code stands. All according to plan. -->
	</Operation>
	
	<Operation Class="PatchOperationConditional">
	<!-- DO THE GENTILES KNOW? -->
		<xpath>Defs/ThingDef[defName="AB_Mudstone"]</xpath>
		<!-- If they do, SHUT IT DOWN. -->
		<match Class="PatchOperationRemove">
			<success>Always</success>
			<xpath>Defs/ThingDef[defName="ST_MudstoneBricks"]</xpath>
		</match>
		<!-- If the first XPATH does not exist, the original code stands. All according to plan. -->
	</Operation>
	
	<Operation Class="PatchOperationConditional">
	<!-- DO THE GENTILES KNOW? -->
		<xpath>Defs/ThingDef[defName="AB_Mudstone"]</xpath>
		<!-- If they do, SHUT IT DOWN. -->
		<match Class="PatchOperationRemove">
			<success>Always</success>
			<xpath>Defs/RecipeDef[defName="ST_Make_MudstoneBricks"]</xpath>
		</match>
		<!-- If the first XPATH does not exist, the original code stands. All according to plan. -->
	</Operation>
	
	<Operation Class="PatchOperationConditional">
	<!-- DO THE GENTILES KNOW? -->
		<xpath>Defs/ThingDef[defName="AB_Mudstone"]</xpath>
		<!-- If they do, SHUT IT DOWN. -->
		<match Class="PatchOperationRemove">
			<success>Always</success>
			<xpath>Defs/TerrainDef[defName="ST_TileMudstone"]</xpath>
		</match>
		<!-- If the first XPATH does not exist, the original code stands. All according to plan. -->
	</Operation>
	
	<Operation Class="PatchOperationConditional">
	<!-- DO THE GENTILES KNOW? -->
		<xpath>Defs/ThingDef[defName="AB_Mudstone"]</xpath>
		<!-- If they do, SHUT IT DOWN. -->
		<match Class="PatchOperationRemove">
			<success>Always</success>
			<xpath>Defs/RecipeDef/product/ST_MudstoneBricks</xpath>
		</match>
		<!-- If the first XPATH does not exist, the original code stands. All according to plan. -->
	</Operation>
	
  <Operation Class="PatchOperationConditional">
    <!-- Does this exist? -->
    <xpath>Defs/ThingDef[defName="AB_Mudstone"]</xpath>
    <!-- If it does, LET'S FASTING GOOOOOOOOOO!!! -->
    <match Class="PatchOperationSequence">
      <!-- <success>Always</success> -->
      <operations>
        <li Class="PatchOperationInsert">
          <xpath>Defs/RecipeDef/ingredients/li/filter/thingDefs/li[text()="ST_MudstoneBricks"]</xpath>
          <success>Always</success>
          <value>
            <li MayRequire="sarg.alphabiomes">AB_BlocksMudstone</li>
          </value>
        </li>
        <li Class="PatchOperationInsert">
          <xpath>Defs/RecipeDef/fixedIngredientFilter/thingDefs/li[text()="ST_MudstoneBricks"]</xpath>
          <success>Always</success>
          <value>
			<li MayRequire="sarg.alphabiomes">AB_BlocksMudstone</li>
          </value>
        </li>
        <li Class="PatchOperationInsert">
          <xpath>Defs/RecipeDef/defaultIngredientFilter/thingDefs/li[text()="ST_MudstoneBricks"]</xpath>
          <success>Always</success>
          <value>
			<li MayRequire="sarg.alphabiomes">AB_BlocksMudstone</li>
          </value>
        </li>
        <li Class="PatchOperationRemove">
          <success>Always</success>
          <xpath>Defs/RecipeDef/ingredients/li/filter/li/thingDefs/li[text()="ST_MudstoneBricks"]</xpath>
        </li>
        <li Class="PatchOperationRemove">
          <success>Always</success>
          <xpath>Defs/RecipeDef/ingredients/li/filter/li/thingDefs/li[text()="ST_MudstoneBricks"]</xpath>
        </li>
        <li Class="PatchOperationRemove">
          <success>Always</success>
          <xpath>Defs/RecipeDef/fixedIngredientFilter/thingDefs/li[text()="ST_MudstoneBricks"]</xpath>
        </li>
        <li Class="PatchOperationRemove">
          <success>Always</success>
          <xpath>Defs/RecipeDef/defaultIngredientFilter/thingDefs/li[text()="ST_MudstoneBricks"]</xpath>
        </li>
		<li Class="PatchOperationReplace">
			<success>Always</success>
			<xpath>Defs/ThingDef/costList/ST_MudstoneBricks</xpath>
			<value>
				<AB_BlocksMudstone MayRequire="sarg.alphabiomes">2</AB_BlocksMudstone>
			</value>
		</li>
		<li Class="PatchOperationReplace">
			<success>Always</success>
			<xpath>Defs/TerrainDef/costList/ST_MudstoneBricks</xpath>
			<value>
				<AB_BlocksMudstone MayRequire="sarg.alphabiomes">2</AB_BlocksMudstone>
			</value>
		</li>		
        <li Class="PatchOperationRemove">
          <success>Always</success>
          <xpath>Defs/ThingDef[defName="ST_MudstoneBricks"]</xpath>
        </li>
        <li Class="PatchOperationAdd">
          <success>Always</success>
          <xpath>/Defs</xpath>
          <value>
				<ThingDef ParentName="BaseFilth">
					<defName>ST_MudstoneBricks</defName>
					<label>Mud Stone Bricks (ERROR)</label>
					<category>Filth</category>
					<description>The Alpha Biomes Mod adds its own version of "mud stone" to the game, and removes the version of the mud stone from the Storytime Mod. If this is ever encountered in the game as an item, you are seeing an error. Please report it to TurtleShroom.</description>
					<graphicData>
						<texPath>Things/Item/Resource/StoneBlocks</texPath>
						<graphicClass>Graphic_StackCount</graphicClass>
						<color>(130, 84, 62)</color>
					</graphicData>
					<altitudeLayer>Filth</altitudeLayer>
					<selectable>true</selectable>
					<statBases>
						<Flammability>0</Flammability>
					</statBases>
					<filth Inherit="False">
						<cleaningSound Inherit="False">Metal_Drop</cleaningSound>
						<ignoreFilthMultiplierStat>true</ignoreFilthMultiplierStat>
						<disappearsInDays>0.001~0.05</disappearsInDays>
						<rainWashes>true</rainWashes>
						<cleaningWorkToReduceThickness>1</cleaningWorkToReduceThickness>
						<canFilthAttach>false</canFilthAttach>
					</filth>
				</ThingDef>
          </value>
        </li>
      </operations>
    </match>
  </Operation>
</Patch>