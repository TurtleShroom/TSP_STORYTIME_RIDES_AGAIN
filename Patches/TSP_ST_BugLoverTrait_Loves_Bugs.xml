<?xml version="1.0" encoding="utf-8" ?>

<Patch>
	<Operation Class="PatchOperationConditional">
	<!-- Does this exist? -->
	<xpath>/Defs/ThoughtDef[defName="AteInsectMeatDirect"]/nullifyingTraits</xpath>
		<!-- If it does, add this. -->
		<match Class="PatchOperationAdd">
			<success>Always</success>
			<xpath>/Defs/ThoughtDef[defName="AteInsectMeatDirect"]/nullifyingTraits</xpath>
			<value>
				<li>Buglover</li>
				<li>Entomophagous</li>
				<li>ST_SemiFeral</li>
			</value>
		</match>
		<!-- If it DOES NOT, add this instead. -->
		<nomatch Class="PatchOperationAdd">
			<success>Always</success>
			<xpath>/Defs/ThoughtDef[defName="AteInsectMeatDirect"]</xpath>
			<value>
				<nullifyingTraits>
					<li>Buglover</li>
					<li>Entomophagous</li>
					<li>ST_SemiFeral</li>
				</nullifyingTraits>
			</value>
		</nomatch>
		<!-- If the first XPATH does not exist, the original code stands. -->
	</Operation>

	<Operation Class="PatchOperationConditional">
	<!-- Does this exist? -->
	<xpath>/Defs/ThoughtDef[defName="AteInsectMeatAsIngredient"]/nullifyingTraits</xpath>
		<!-- If it does, add this. -->
		<match Class="PatchOperationAdd">
			<success>Always</success>
			<xpath>/Defs/ThoughtDef[defName="AteInsectMeatAsIngredient"]/nullifyingTraits</xpath>
			<value>
				<li>Buglover</li>
				<li>Entomophagous</li>
				<li>ST_SemiFeral</li>
			</value>
		</match>
		<!-- If it DOES NOT, add this instead. -->
		<nomatch Class="PatchOperationAdd">
			<success>Always</success>
			<xpath>/Defs/ThoughtDef[defName="AteInsectMeatAsIngredient"]</xpath>
			<value>
				<nullifyingTraits>
					<li>Buglover</li>
					<li>Entomophagous</li>
					<li>ST_SemiFeral</li>
				</nullifyingTraits>
			</value>
		</nomatch>
		<!-- If the first XPATH does not exist, the original code stands. -->
	</Operation>
	
	<Operation Class="PatchOperationConditional">
	<!-- Does this exist? -->
	<xpath>/Defs/MemeDef[defName="VME_Structure_Serketist"]</xpath>
		<!-- If it does, add this. -->
		<match Class="PatchOperationAdd">
			<success>Always</success>
			<xpath>/Defs/MemeDef[defName="VME_Structure_Serketist"]</xpath>
			<value>
				<disagreeableTraits>
					<li>Buglover</li>
					<li>Entomophagous</li>
				</disagreeableTraits>				
			</value>
		</match>
		<!-- If the first XPATH does not exist, the original code stands. -->
	</Operation>
	
	<Operation Class="PatchOperationConditional">
	<!-- Does this exist? -->
	<xpath>/Defs/MemeDef[defName="VME_InsectoidSupremacy"]</xpath>
		<!-- If it does, add this. -->
		<match Class="PatchOperationAdd">
			<success>Always</success>
			<xpath>/Defs/MemeDef[defName="VME_InsectoidSupremacy"]</xpath>
			<value>
				<disagreeableTraits>
					<li>Buglover</li>
					<li>Entomophagous</li>
				</disagreeableTraits>
			</value>
		</match>
		<!-- If the first XPATH does not exist, the original code stands. -->
	</Operation>
	
	<Operation Class="PatchOperationConditional">
	<!-- Does this exist? -->
	<xpath>/Defs/MemeDef[defName="InsectoidPrimacy"]</xpath>
		<!-- If it does, add this. -->
		<match Class="PatchOperationAdd">
			<success>Always</success>
			<xpath>/Defs/MemeDef[defName="InsectoidPrimacy"]</xpath>
			<value>
				<disagreeableTraits>
					<li>Buglover</li>
					<li>Entomophagous</li>
				</disagreeableTraits>				
			</value>
		</match>
		<!-- If the first XPATH does not exist, the original code stands. -->
	</Operation>
	
	<Operation Class="PatchOperationConditional">
	<!-- Does this exist? -->
	<xpath>/Defs/MemeDef[defName="VME_Structure_Serketist"]</xpath>
		<!-- If it does, add this. -->
		<match Class="PatchOperationAdd">
			<success>Always</success>
			<xpath>/Defs/ThoughtDef[defName="VME_EntrancingInsectoidHymn"]</xpath>
			<value>
				<nullifyingTraits>
					<li>Buglover</li>
					<li>Entomophagous</li>
				</nullifyingTraits>	
			</value>
		</match>
		<!-- If the first XPATH does not exist, the original code stands. -->
	</Operation>
	
	<Operation Class="PatchOperationConditional">
	<!-- Does this exist? -->
	<xpath>/Defs/MemeDef[defName="VME_Structure_Serketist"]</xpath>
		<!-- If it does, add this. -->
		<match Class="PatchOperationAdd">
			<success>Always</success>
			<xpath>/Defs/ThoughtDef[defName="VME_RousingInsectoidHymn"]</xpath>
			<value>
				<nullifyingTraits>
					<li>Buglover</li>
					<li>Entomophagous</li>
				</nullifyingTraits>	
			</value>
		</match>
		<!-- If the first XPATH does not exist, the original code stands. -->
	</Operation>
	
	<Operation Class="PatchOperationConditional">
	<!-- Does this exist? -->
	<xpath>/Defs/MemeDef[defName="VME_Structure_Serketist"]</xpath>
		<!-- If it does, add this. -->
		<match Class="PatchOperationAdd">
			<success>Always</success>
			<xpath>/Defs/ThoughtDef[defName="VME_InsectMeatEating_Sacrilegious"]</xpath>
			<value>
				<nullifyingTraits>
					<li>Buglover</li>
					<li>Entomophagous</li>
				</nullifyingTraits>	
			</value>
		</match>
		<!-- If the first XPATH does not exist, the original code stands. -->
	</Operation>
	
	<Operation Class="PatchOperationConditional">
	<!-- Does this exist? -->
	<xpath>/Defs/MemeDef[defName="VME_Structure_Serketist"]</xpath>
		<!-- If it does, add this. -->
		<match Class="PatchOperationAdd">
			<success>Always</success>
			<xpath>/Defs/ThoughtDef[defName="VME_AteInsectMeatAsIngredient_Sacrilegious"]</xpath>
			<value>
				<nullifyingTraits>
					<li>Buglover</li>
					<li>Entomophagous</li>
				</nullifyingTraits>	
			</value>
		</match>
		<!-- If the first XPATH does not exist, the original code stands. -->
	</Operation>
	
	<Operation Class="PatchOperationConditional">
	<!-- Does this exist? -->
	<xpath>/Defs/MemeDef[defName="VME_Structure_Serketist"]</xpath>
		<!-- If it does, add this. -->
		<match Class="PatchOperationAdd">
			<success>Always</success>
			<xpath>/Defs/ThoughtDef[defName="VME_Insectoids_Exalted"]</xpath>
			<value>
				<nullifyingTraits>
					<li>Buglover</li>
					<li>Entomophagous</li>
				</nullifyingTraits>	
			</value>
		</match>
		<!-- If the first XPATH does not exist, the original code stands. -->
	</Operation>
	
	<Operation Class="PatchOperationConditional">
	<!-- Does this exist? -->
	<xpath>/Defs/PreceptDef[defName="InsectMeatEating_Loved"]/associatedMemes</xpath>
		<!-- If it does, add this. -->
		<match Class="PatchOperationAdd">
			<success>Always</success>
			<xpath>/Defs/Precept[defName="InsectMeatEating_Loved"]/associatedMemes</xpath>
			<value>
				<li>STFrogPersonOrigin</li>
			</value>
		</match>
		<!-- If it DOES NOT, add this instead. -->
		<nomatch Class="PatchOperationAdd">
			<success>Always</success>
			<xpath>/Defs/Precept[defName="InsectMeatEating_Loved"]</xpath>
			<value>
				<associatedMemes>
					<li>STFrogPersonOrigin</li>
				</associatedMemes>
			</value>
		</nomatch>
		<!-- If the first XPATH does not exist, the original code stands. -->
	</Operation>
	
	<Operation Class="PatchOperationConditional">
	<!-- Does this exist? -->
	<xpath>/Defs/ThoughtDef[defName="ForagedForBugs"]</xpath>
		<!-- If it does, do this replacement. -->
		<match Class="PatchOperationReplace">
			<success>Always</success>
			<xpath>/Defs/ThoughtDef[defName="ForagedForBugs"]/requiredTraits</xpath>
			<value>
				<requiredTraits>
					<li>Buglover</li>
					<li>Entomophagous</li>
					<li>ST_SemiFeral</li>
					<li>BeanMan</li>
				</requiredTraits>
			</value>
		</match>
		<!-- If the first XPATH does not exist, the original code stands. -->
	</Operation>
	
	<Operation Class="PatchOperationConditional">
	<!-- DO THE GENTILES KNOW? -->
	<xpath>/Defs/ThoughtDef[defName="ForagedForBugs"]</xpath>
		<!-- If they do, SHUT IT DOWN. -->
		<match Class="PatchOperationRemove">
			<success>Always</success>
			<xpath>/Defs/ThoughtDef[defName="ForagedForBugs"]/requiredTraits</xpath>
		</match>
		<!-- If the first XPATH does not exist, the original code stands. All according to plan. -->
	</Operation>
	
	<Operation Class="PatchOperationConditional">
	<!-- Does this exist? -->
	<xpath>/Defs/MentalStateDef[defName="BugForaging"]</xpath>
		<!-- If it does, do this replacement. -->
		<match Class="PatchOperationReplace">
			<success>Always</success>
			<xpath>/Defs/MentalStateDef[defName="BugForaging"]/category</xpath>
			<value>
				<category>Misc</category>
			</value>
		</match>
		<!-- If the first XPATH does not exist, the original code stands. -->
	</Operation>
	
	<Operation Class="PatchOperationConditional">
	<!-- Does this exist? -->
	<xpath>/Defs/MentalBreakDef[defName="BugForaging"]</xpath>
		<!-- If it does, add this. -->
		<match Class="PatchOperationAdd">
			<success>Always</success>
			<xpath>/Defs</xpath>
			<value>
				<MentalBreakDef>
					<defName>TSP_BugForagingDuplicate_BugLover</defName>
					<mentalState>BugForaging</mentalState>
					<baseCommonality>0.04</baseCommonality>
					<intensity>Minor</intensity>
					<requiredTrait>Buglover</requiredTrait>
				</MentalBreakDef>
				
				<MentalBreakDef>
					<defName>TSP_BugForagingDuplicate_SemiFeral</defName>
					<mentalState>BugForaging</mentalState>
					<baseCommonality>0.01</baseCommonality>
					<intensity>Minor</intensity>
					<requiredTrait>ST_SemiFeral</requiredTrait>
				</MentalBreakDef>
				
				<MentalBreakDef>
					<defName>TSP_BugForagingDuplicate_Bulborb</defName>
					<mentalState>BugForaging</mentalState>
					<baseCommonality>0.02</baseCommonality>
					<intensity>Minor</intensity>
					<requiredTrait>BeanMan</requiredTrait>
				</MentalBreakDef>
			</value>
		</match>
		<!-- If the first XPATH does not exist, the original code stands. -->
	</Operation>
	
	<Operation Class="PatchOperationConditional">
	<!-- DO THE GENTILES KNOW? -->
	<xpath>/Defs/ThoughtDef[defName="ForagedForBugs"]</xpath>
		<!-- If they do, SHUT IT DOWN. -->
		<match Class="PatchOperationRemove">
			<success>Always</success>
			<xpath>/Defs/ThoughtDef[defName="ForagedForBugs"]/requiredTraits</xpath>
		</match>
		<!-- If the first XPATH does not exist, the original code stands. All according to plan. -->
	</Operation>
	
	<!--
	<Operation Class="PatchOperationConditional">
	Does this exist?
	<xpath>/Defs/ThoughtDef[defName="ForagedForBugs"]</xpath>
		If it does, do this replacement.
		<match Class="PatchOperationReplace">
			<success>Always</success>
			<xpath>/Defs/ThoughtDef[defName="ForagedForBugs"]/stages</xpath>
			<value>
				<stages>
					<li>
						<label>insect nature stroll</label>
						<description>To calm myself, I took a stroll and observed some little insects. I picked a few up and let them crawl on me. I feel.... oddly calmer.</description>
						<baseMoodEffect>20</baseMoodEffect>
					</li>
				</stages>
			</value>
		</match>
		If the first XPATH does not exist, the original code stands.
	</Operation>
	-->
	
	<Operation Class="PatchOperationConditional">
	<!-- Does this exist? -->
	<xpath>/Defs/ThoughtDef[defName="ForagedForBugs"]</xpath>
		<!-- If it does, do this replacement. -->
		<match Class="PatchOperationReplace">
			<success>Always</success>
			<xpath>/Defs/ThoughtDef[defName="ForagedForBugs"]/durationDays</xpath>
			<value>
				<durationDays>4</durationDays> <!-- Longer than normal Catharsis -->
			</value>
		</match>
		<!-- If the first XPATH does not exist, the original code stands. -->
	</Operation>
	
	<Operation Class="PatchOperationConditional">
	<!-- DO THE GENTILES KNOW? -->
	<xpath>/Defs/ThoughtDef[defName="ForagedForBugs"]</xpath>
		<!-- If they do, SHUT IT DOWN. -->
		<match Class="PatchOperationRemove">
			<success>Always</success>
			<xpath>/Defs/ThoughtDef[defName="ForagedForBugs"]/requiredTraits</xpath>
		</match>
		<!-- If the first XPATH does not exist, the original code stands. All according to plan. -->
	</Operation>
	
	<Operation Class="PatchOperationConditional">
	<!-- Does this exist? -->
	<xpath>/Defs/MentalStateDef[defName="BugForaging"]</xpath>
		<!-- If it does, do this replacement. -->
		<match Class="PatchOperationReplace">
			<success>Always</success>
			<xpath>/Defs/MentalStateDef[defName="BugForaging"]/prisonersCanDo</xpath>
			<value>
				<prisonersCanDo>true</prisonersCanDo>
			</value>
		</match>
		<!-- If the first XPATH does not exist, the original code stands. -->
	</Operation>
	
	<Operation Class="PatchOperationConditional">
	<!-- Does this exist? -->
	<xpath>/Defs/MentalStateDef[defName="BugForaging"]</xpath>
		<!-- If it does, do this replacement. -->
		<match Class="PatchOperationReplace">
			<success>Always</success>
			<xpath>/Defs/MentalStateDef[defName="BugForaging"]/prisonersCanDo</xpath>
			<value>
				<prisonersCanDo>true</prisonersCanDo>
			</value>
		</match>
		<!-- If the first XPATH does not exist, the original code stands. -->
	</Operation>
	
	<Operation Class="PatchOperationConditional">
	<!-- Does this exist? -->
	<xpath>/Defs/ThoughtDef[defName="ObservedForaging"]</xpath>
		<!-- If it does, do this replacement. -->
		<match Class="PatchOperationReplace">
			<success>Always</success>
			<xpath>/Defs/ThoughtDef[defName="ObservedForaging"]/nullifyingTraits</xpath>
			<value>
				<nullifyingTraits>
					<li>Buglover</li>
					<li>Entomophagous</li>
					<li>BeanMan</li>
					<li>ST_SemiFeral</li>
				</nullifyingTraits>
			</value>
		</match>
		<!-- If the first XPATH does not exist, the original code stands. -->
	</Operation>
</Patch>