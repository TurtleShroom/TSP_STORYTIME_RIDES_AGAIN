<?xml version="1.0" encoding="utf-8"?>

<Patch>
	<!-- Aelanna's Model No-li Detector and Insertion Code -->
	<!-- Special thanks to Aelanna for straight-up saving me scores of headaches! -->
	<!-- Add comps field to Settlement WorldObjectDef if it doesn't exist -->
	<Operation Class="PatchOperationConditional">
		<xpath>/Defs/RecipeDef[defName="Make_CannedFood"]/fixedIngredientFilter</xpath>
		<nomatch Class="PatchOperationAdd">
			<xpath>/Defs/RecipeDef[defName="Make_CannedFood"]</xpath>
			<success>Always</success>
			<value>
				<fixedIngredientFilter></fixedIngredientFilter>
			</value>
		</nomatch>
	</Operation>
	
	<!-- Add comps field to Settlement WorldObjectDef if it doesn't exist -->
	<Operation Class="PatchOperationConditional">
		<xpath>/Defs/RecipeDef[defName="Make_CannedFood"]/fixedIngredientFilter/thingDefs</xpath>
		<nomatch Class="PatchOperationAdd">
			<xpath>/Defs/RecipeDef[defName="Make_CannedFood"]/fixedIngredientFilter</xpath>
			<success>Always</success>
			<value>
				<thingDefs></thingDefs>
			</value>
		</nomatch>
	</Operation>
	
	<!-- Add comps field to Settlement WorldObjectDef if it doesn't exist -->
	<Operation Class="PatchOperationConditional">
		<xpath>/Defs/RecipeDef[defName="Make_NutPowder"]/fixedIngredientFilter</xpath>
		<nomatch Class="PatchOperationAdd">
			<xpath>/Defs/RecipeDef[defName="Make_NutPowder"]</xpath>
			<success>Always</success>
			<value>
				<fixedIngredientFilter></fixedIngredientFilter>
			</value>
		</nomatch>
	</Operation>
	
	<!-- Add comps field to Settlement WorldObjectDef if it doesn't exist -->
	<Operation Class="PatchOperationConditional">
		<xpath>/Defs/RecipeDef[defName="Make_NutPowder"]/fixedIngredientFilter/thingDefs</xpath>
		<nomatch Class="PatchOperationAdd">
			<xpath>/Defs/RecipeDef[defName="Make_NutPowder"]/fixedIngredientFilter</xpath>
			<success>Always</success>
			<value>
				<thingDefs></thingDefs>
			</value>
		</nomatch>
	</Operation>
	
	<!-- Add comps field to Settlement WorldObjectDef if it doesn't exist -->
	<Operation Class="PatchOperationConditional">
		<xpath>/Defs/RecipeDef[defName="Make_FoodBars"]/fixedIngredientFilter</xpath>
		<nomatch Class="PatchOperationAdd">
			<xpath>/Defs/RecipeDef[defName="Make_FoodBars"]</xpath>
			<success>Always</success>
			<value>
				<fixedIngredientFilter></fixedIngredientFilter>
			</value>
		</nomatch>
	</Operation>
	
	<!-- Add comps field to Settlement WorldObjectDef if it doesn't exist -->
	<Operation Class="PatchOperationConditional">
		<xpath>/Defs/RecipeDef[defName="Make_FoodBars"]/fixedIngredientFilter/thingDefs</xpath>
		<nomatch Class="PatchOperationAdd">
			<xpath>/Defs/RecipeDef[defName="Make_FoodBars"]/fixedIngredientFilter</xpath>
			<success>Always</success>
			<value>
				<thingDefs></thingDefs>
			</value>
		</nomatch>
	</Operation>
	
	<!-- Add comps field to Settlement WorldObjectDef if it doesn't exist -->
	<Operation Class="PatchOperationConditional">
		<xpath>/Defs/RecipeDef[defName="Make_FoodBars"]/fixedIngredientFilter</xpath>
		<nomatch Class="PatchOperationAdd">
			<xpath>/Defs/RecipeDef[defName="Make_FoodBars"]</xpath>
			<success>Always</success>
			<value>
				<fixedIngredientFilter></fixedIngredientFilter>
			</value>
		</nomatch>
	</Operation>
	
	<!-- Add comps field to Settlement WorldObjectDef if it doesn't exist -->
	<Operation Class="PatchOperationConditional">
		<xpath>/Defs/RecipeDef[defName="Make_FoodBars"]/fixedIngredientFilter/thingDefs</xpath>
		<nomatch Class="PatchOperationAdd">
			<xpath>/Defs/RecipeDef[defName="Make_FoodBars"]/fixedIngredientFilter</xpath>
			<success>Always</success>
			<value>
				<thingDefs></thingDefs>
			</value>
		</nomatch>
	</Operation>

	<Operation Class="PatchOperationConditional">
		<xpath>/Defs/RecipeDef[defName="VCE_CanMeats"]/ingredients/li/filter/thingDefs</xpath>
		<match Class="PatchOperationAdd">
			<xpath>/Defs/RecipeDef[defName = "VCE_CanMeats" or defName = "VCE_CanProduce" or defName = "VCE_CanFruit" or defName = "VCE_CanEggs"]/ingredients/li[2]/filter/thingDefs</xpath>
			<success>Always</success>
			<value>
				<li>Steel</li>
				<li MayRequire="mlie.ancientrimcore">AR_Copper</li>
				<li MayRequire="mlie.ancientrimcore">AR_Bronze</li>
				<li MayRequire="TSP.Isengriff.BronzeCopperTin.Split">ST_Copper</li>
				<li MayRequire="TSP.Isengriff.BronzeCopperTin.Split">ST_Tin</li>
				<li MayRequire="TSP.Isengriff.BronzeCopperTin.Split">ST_Bronze</li>
				<li MayRequire="TSP.Isengriff.Storytime">ST_Blackium</li>
				<li MayRequire="TSP.Isengriff.Storytime">Asbestos_Tile</li>
				<li MayRequire="TSP.Isengriff.Storytime">Weezer</li>
				<li MayRequire="TSP.Isengriff.Storytime">ST_MudstoneBricks</li>
			</value>
		</match>
	</Operation>
	
	<Operation Class="PatchOperationConditional">
		<xpath>/Defs/RecipeDef[defName="VCE_CanMeats"]/fixedIngredientFilter/thingDefs</xpath>
		<match Class="PatchOperationAdd">
			<xpath>/Defs/RecipeDef[defName = "VCE_CanMeats" or defName = "VCE_CanProduce" or defName = "VCE_CanFruit" or defName = "VCE_CanEggs"]/fixedIngredientFilter/thingDefs</xpath>
			<success>Always</success>
			<value>
				<li>Steel</li>
				<li MayRequire="mlie.ancientrimcore">AR_Copper</li>
				<li MayRequire="mlie.ancientrimcore">AR_Bronze</li>
				<li MayRequire="TSP.Isengriff.BronzeCopperTin.Split">ST_Copper</li>
				<li MayRequire="TSP.Isengriff.BronzeCopperTin.Split">ST_Tin</li>
				<li MayRequire="TSP.Isengriff.BronzeCopperTin.Split">ST_Bronze</li>
				<li MayRequire="TSP.Isengriff.Storytime">ST_Blackium</li>
				<li MayRequire="TSP.Isengriff.Storytime">Asbestos_Tile</li>
				<li MayRequire="TSP.Isengriff.Storytime">Weezer</li>
				<li MayRequire="TSP.Isengriff.Storytime">ST_MudstoneBricks</li>
			</value>
		</match>
	</Operation>
	
	<Operation Class="PatchOperationConditional">
		<xpath>/Defs/RecipeDef[defName="VCE_CanMeats"]/defaultIngredientFilter/thingDefs</xpath>
		<match Class="PatchOperationAdd">
			<xpath>/Defs/RecipeDef[defName = "VCE_CanMeats" or defName = "VCE_CanProduce" or defName = "VCE_CanFruit" or defName = "VCE_CanEggs"]/defaultIngredientFilter/thingDefs</xpath>
			<success>Always</success>
			<value>
				<li>Steel</li>
				<li MayRequire="mlie.ancientrimcore">AR_Copper</li>
				<li MayRequire="TSP.Isengriff.BronzeCopperTin.Split">ST_Copper</li>
				<li MayRequire="TSP.Isengriff.BronzeCopperTin.Split">ST_Tin</li>
				<li MayRequire="TSP.Isengriff.Storytime">ST_MudstoneBricks</li>
			</value>
		</match>
	</Operation>
	
	<Operation Class="PatchOperationConditional">
		<xpath>/Defs/RecipeDef[defName="VCE_CanFish"]/ingredients/li/filter/thingDefs</xpath>
		<match Class="PatchOperationAdd">
			<xpath>/Defs/RecipeDef[defName="VCE_CanFish"]/ingredients/li[2]/filter/thingDefs</xpath>
			<success>Always</success>
			<value>
				<li>Steel</li>
				<li MayRequire="mlie.ancientrimcore">AR_Copper</li>
				<li MayRequire="mlie.ancientrimcore">AR_Bronze</li>
				<li MayRequire="TSP.Isengriff.BronzeCopperTin.Split">ST_Copper</li>
				<li MayRequire="TSP.Isengriff.BronzeCopperTin.Split">ST_Tin</li>
				<li MayRequire="TSP.Isengriff.BronzeCopperTin.Split">ST_Bronze</li>
				<li MayRequire="TSP.Isengriff.Storytime">ST_Blackium</li>
				<li MayRequire="TSP.Isengriff.Storytime">Asbestos_Tile</li>
				<li MayRequire="TSP.Isengriff.Storytime">Weezer</li>
				<li MayRequire="TSP.Isengriff.Storytime">ST_MudstoneBricks</li>
			</value>
		</match>
	</Operation>
	
	<Operation Class="PatchOperationConditional">
		<xpath>/Defs/RecipeDef[defName="VCE_CanFish"]/fixedIngredientFilter/thingDefs</xpath>
		<match Class="PatchOperationAdd">
			<xpath>/Defs/RecipeDef[defName="VCE_CanFish"]/fixedIngredientFilter/thingDefs</xpath>
			<success>Always</success>
			<value>
				<li>Steel</li>
				<li MayRequire="mlie.ancientrimcore">AR_Copper</li>
				<li MayRequire="mlie.ancientrimcore">AR_Bronze</li>
				<li MayRequire="TSP.Isengriff.BronzeCopperTin.Split">ST_Copper</li>
				<li MayRequire="TSP.Isengriff.BronzeCopperTin.Split">ST_Tin</li>
				<li MayRequire="TSP.Isengriff.BronzeCopperTin.Split">ST_Bronze</li>
				<li MayRequire="TSP.Isengriff.Storytime">ST_Blackium</li>
				<li MayRequire="TSP.Isengriff.Storytime">Asbestos_Tile</li>
				<li MayRequire="TSP.Isengriff.Storytime">Weezer</li>
				<li MayRequire="TSP.Isengriff.Storytime">ST_MudstoneBricks</li>
			</value>
		</match>
	</Operation>
	
	<Operation Class="PatchOperationConditional">
		<xpath>/Defs/RecipeDef[defName="VCE_CanFish"]/defaultIngredientFilter/thingDefs</xpath>
		<match Class="PatchOperationAdd">
			<xpath>/Defs/RecipeDef[defName = "VCE_CanFish"]/defaultIngredientFilter/thingDefs</xpath>
			<success>Always</success>
			<value>
				<li>Steel</li>
				<li MayRequire="mlie.ancientrimcore">AR_Copper</li>
				<li MayRequire="TSP.Isengriff.BronzeCopperTin.Split">ST_Copper</li>
				<li MayRequire="TSP.Isengriff.BronzeCopperTin.Split">ST_Tin</li>
				<li MayRequire="TSP.Isengriff.Storytime">ST_MudstoneBricks</li>
			</value>
		</match>
	</Operation>
	
	<Operation Class="PatchOperationConditional">
		<xpath>/Defs/RecipeDef[defName="Make_CannedFood"]</xpath>
		<match Class="PatchOperationAdd">
			<xpath>/Defs/RecipeDef[defName="Make_CannedFood"]/ingredients/li[3]/filter/thingDefs</xpath>
			<success>Always</success>
			<value>
				<li>Steel</li>
				<li MayRequire="mlie.ancientrimcore">AR_Copper</li>
				<li MayRequire="mlie.ancientrimcore">AR_Bronze</li>
				<li MayRequire="TSP.Isengriff.BronzeCopperTin.Split">ST_Copper</li>
				<li MayRequire="TSP.Isengriff.BronzeCopperTin.Split">ST_Tin</li>
				<li MayRequire="TSP.Isengriff.BronzeCopperTin.Split">ST_Bronze</li>
				<li MayRequire="TSP.Isengriff.Storytime">ST_Blackium</li>
				<li MayRequire="TSP.Isengriff.Storytime">Asbestos_Tile</li>
				<li MayRequire="TSP.Isengriff.Storytime">Weezer</li>
				<li MayRequire="TSP.Isengriff.Storytime">ST_MudstoneBricks</li>
			</value>
		</match>
	</Operation>
	
	<Operation Class="PatchOperationConditional">
		<xpath>/Defs/RecipeDef[defName="Make_CannedFood"]</xpath>
		<match Class="PatchOperationAdd">
			<xpath>/Defs/RecipeDef[defName="Make_CannedFood"]/fixedIngredientFilter/thingDefs</xpath>
			<success>Always</success>
			<value>
				<li>Steel</li>
				<li MayRequire="mlie.ancientrimcore">AR_Copper</li>
				<li MayRequire="mlie.ancientrimcore">AR_Bronze</li>
				<li MayRequire="TSP.Isengriff.BronzeCopperTin.Split">ST_Copper</li>
				<li MayRequire="TSP.Isengriff.BronzeCopperTin.Split">ST_Tin</li>
				<li MayRequire="TSP.Isengriff.BronzeCopperTin.Split">ST_Bronze</li>
				<li MayRequire="TSP.Isengriff.Storytime">ST_Blackium</li>
				<li MayRequire="TSP.Isengriff.Storytime">Asbestos_Tile</li>
				<li MayRequire="TSP.Isengriff.Storytime">Weezer</li>
				<li MayRequire="TSP.Isengriff.Storytime">ST_MudstoneBricks</li>
			</value>
		</match>
	</Operation>
	
	<Operation Class="PatchOperationConditional">
		<xpath>/Defs/RecipeDef[defName="Make_CannedFood"]/defaultIngredientFilter/thingDefs</xpath>
		<match Class="PatchOperationAdd">
			<xpath>/Defs/RecipeDef[defName = "Make_CannedFood"]/defaultIngredientFilter/thingDefs</xpath>
			<success>Always</success>
			<value>
				<li>Steel</li>
				<li MayRequire="mlie.ancientrimcore">AR_Copper</li>
				<li MayRequire="TSP.Isengriff.BronzeCopperTin.Split">ST_Copper</li>
				<li MayRequire="TSP.Isengriff.BronzeCopperTin.Split">ST_Tin</li>
				<li MayRequire="TSP.Isengriff.Storytime">ST_MudstoneBricks</li>
			</value>
		</match>
	</Operation>
	
	<Operation Class="PatchOperationConditional">
		<xpath>/Defs/RecipeDef[defName="Make_NutPowder"]/fixedIngredientFilter/thingDefs</xpath>
		<match Class="PatchOperationAdd">
			<xpath>/Defs/RecipeDef[defName="Make_NutPowder"]/fixedIngredientFilter/thingDefs</xpath>
			<success>Always</success>
			<value>
				<li>Neutroamine</li>
			</value>
		</match>
	</Operation>
	
	<Operation Class="PatchOperationConditional">
		<xpath>/Defs/RecipeDef[defName="Make_FoodBars"]/fixedIngredientFilter/thingDefs</xpath>
		<match Class="PatchOperationAdd">
			<xpath>/Defs/RecipeDef[defName="Make_FoodBars"]/fixedIngredientFilter/thingDefs</xpath>
			<success>Always</success>
			<value>
				<li>Chocolate</li>
			</value>
		</match>
	</Operation>
</Patch>